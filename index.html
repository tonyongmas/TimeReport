<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô(‡∏á‡∏≤‡∏ô‡πÄ‡∏ó‡∏®‡∏Å‡∏¥‡∏à)‡∏ó‡∏ï.‡∏ï‡∏±‡∏ô‡∏´‡∏¢‡∏á‡∏°‡∏±‡∏™</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Kanit', sans-serif; -webkit-tap-highlight-color: transparent; }
        .btn-select { transition: all 0.2s; border: 2px solid transparent; opacity: 0.8; transform: scale(0.98); }
        .btn-select.active { border-color: #3b82f6; opacity: 1; transform: scale(1); box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.2); background-color: white; }
        .loader { border: 3px solid #e2e8f0; border-top: 3px solid #3b82f6; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-slate-50 min-h-screen pb-20">

    <div class="bg-white/95 backdrop-blur-md shadow-md pt-6 pb-6 px-4 text-center sticky top-0 z-30 rounded-b-3xl">
        <div class="flex flex-col items-center justify-center">
            <img src="https://img2.pic.in.th/pic/71f81565dc59a7f9545542493a5514ab.png" 
                 alt="Logo" 
                 class="w-auto h-28 mb-3 object-contain drop-shadow-xl transform transition hover:scale-105 duration-300">
            <h1 class="text-2xl font-bold text-slate-800 tracking-wide">
                ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
            </h1>
            <p class="text-sm text-slate-500 mt-1 font-light">
                ‡∏á‡∏≤‡∏ô‡πÄ‡∏ó‡∏®‡∏Å‡∏¥‡∏à ‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ï‡∏≥‡∏ö‡∏•‡∏ï‡∏±‡∏ô‡∏´‡∏¢‡∏á‡∏°‡∏±‡∏™
            </p>
        </div>
    </div>

    <div class="max-w-md mx-auto p-5 space-y-5 mt-2">

        <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100">
            <label class="block text-slate-700 mb-2 font-semibold flex items-center gap-2">
                <span class="bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center text-xs">1</span> 
                ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô
            </label>
            <div class="relative">
                <select id="employeeSelect" class="w-full p-3 pl-4 bg-slate-50 border border-slate-200 rounded-xl appearance-none focus:outline-none focus:ring-2 focus:ring-blue-500 text-slate-700 transition">
                    <option value="">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠...</option>
                </select>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-slate-400">‚ñº</div>
            </div>
        </div>

        <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100">
            <label class="block text-slate-700 mb-3 font-semibold flex items-center gap-2">
                <span class="bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center text-xs">2</span>
                ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
            </label>
            <div class="grid grid-cols-3 gap-3">
                <button onclick="selectType('‡πÄ‡∏ä‡πâ‡∏≤', this)" class="btn-select bg-green-50 hover:bg-green-100 text-green-700 py-4 rounded-xl font-medium flex flex-col items-center gap-1">
                    <span class="text-2xl">‚òÄÔ∏è</span><span class="text-sm">‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ß‡∏£‡πÄ‡∏ä‡πâ‡∏≤</span>
                </button>
                <button onclick="selectType('‡∏ö‡πà‡∏≤‡∏¢', this)" class="btn-select bg-orange-50 hover:bg-orange-100 text-orange-700 py-4 rounded-xl font-medium flex flex-col items-center gap-1">
                    <span class="text-2xl">üå§</span><span class="text-sm">‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ß‡∏£‡∏ö‡πà‡∏≤‡∏¢</span>
                </button>
                <button onclick="selectType('‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', this)" class="btn-select bg-red-50 hover:bg-red-100 text-red-700 py-4 rounded-xl font-medium flex flex-col items-center gap-1">
                    <span class="text-2xl">üì¢</span><span class="text-sm">‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤</span>
                </button>
            </div>

            <div id="complaintBox" class="hidden mt-4 pt-4 border-t border-dashed border-red-100 animate-fade-in">
                <label class="text-xs text-red-500 mb-1 block font-medium">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤/‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå:</label>
                <textarea id="complaintDetail" rows="3" class="w-full p-3 border border-red-200 rounded-xl bg-red-50/50 focus:bg-white focus:outline-none focus:border-red-400 focus:ring-1 focus:ring-red-400 placeholder-red-300 transition" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î..."></textarea>
            </div>
        </div>

        <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100">
            <label class="block text-slate-700 mb-2 font-semibold flex items-center gap-2">
                <span class="bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center text-xs">3</span>
                ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (GPS)
            </label>
            <div class="flex gap-2">
                <input type="text" id="gpsInput" readonly class="flex-1 p-3 bg-slate-100 rounded-xl text-slate-500 text-xs font-mono border border-slate-200" placeholder="‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏∏‡∏û‡∏¥‡∏Å‡∏±‡∏î...">
                <button onclick="getLocation()" id="btnGPS" class="bg-blue-600 hover:bg-blue-700 text-white px-4 rounded-xl shadow-md transition flex items-center justify-center gap-2 min-w-[110px] active:scale-95">
                    üìç <span id="gpsLabel" class="text-sm font-medium">‡∏î‡∏∂‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î</span>
                </button>
            </div>
        </div>

        <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100">
            <label class="block text-slate-700 mb-2 font-semibold flex items-center gap-2">
                <span class="bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center text-xs">4</span>
                ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô
            </label>
            
            <input type="file" id="cameraInput" accept="image/*" capture="environment" class="hidden" onchange="previewAndResizeImage(this)">
            
            <div onclick="document.getElementById('cameraInput').click()" 
                 class="border-2 border-dashed border-slate-300 rounded-2xl bg-slate-50 h-56 flex flex-col items-center justify-center cursor-pointer hover:bg-slate-100 hover:border-blue-400 transition relative overflow-hidden group">
                
                <div id="cameraIcon" class="text-center group-hover:scale-110 transition duration-300">
                    <div class="text-5xl mb-3 opacity-40 grayscale">üì∏</div>
                    <span class="text-sm text-slate-500 font-medium">‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û</span>
                    <p class="text-[10px] text-slate-400 mt-1">(‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏¢‡πà‡∏≠‡∏£‡∏π‡∏õ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</p>
                </div>
                
                <img id="preview" class="hidden w-full h-full object-cover absolute inset-0">
                
                <div id="processingImg" class="hidden absolute inset-0 bg-white/80 flex flex-col items-center justify-center z-20">
                    <div class="loader mb-2"></div>
                    <span class="text-xs text-blue-600 font-bold">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏¢‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ...</span>
                </div>

                <button id="btnRemoveImg" onclick="removeImage(event)" class="hidden absolute top-2 right-2 bg-red-500 text-white w-8 h-8 rounded-full shadow-lg z-10 flex items-center justify-center hover:bg-red-600">‚úï</button>
            </div>
        </div>

        <button onclick="submitData()" class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-4 rounded-2xl shadow-lg shadow-blue-200 font-bold text-lg hover:shadow-xl hover:-translate-y-1 active:translate-y-0 active:scale-95 transition duration-200 mt-2 flex items-center justify-center gap-2">
            <span>üöÄ</span> ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö
        </button>
        
        <div class="text-center text-xs text-slate-400 mt-6 pb-4">
            ‡∏á‡∏≤‡∏ô‡πÄ‡∏ó‡∏®‡∏Å‡∏¥‡∏à ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏õ‡∏•‡∏±‡∏î‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏• ‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ï‡∏≥‡∏ö‡∏•‡∏ï‡∏±‡∏ô‡∏´‡∏¢‡∏á‡∏°‡∏±‡∏™ ¬© 2025
        </div>

    </div>

    <script>
        // ******************************************************
        // ‚ö†Ô∏è ‡πÉ‡∏™‡πà URL Web App ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
        // ******************************************************
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzz8WfnnTgUKlv2I2c-cQ627aLzyrfNRcawmSrjNC97szsZzLuL-a0zb4W-Xx12mFBv/exec';

        let base64Image = "";
        let selectedType = "";

        window.onload = loadEmployees;

        function loadEmployees() {
            fetch(SCRIPT_URL + '?op=getEmployees')
                .then(res => res.json())
                .then(data => {
                    const select = document.getElementById('employeeSelect');
                    if (data.status === 'error') throw new Error(data.message);
                    select.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà --</option>';
                    data.forEach(name => {
                        const opt = document.createElement('option');
                        opt.value = name; opt.innerText = name;
                        select.appendChild(opt);
                    });
                })
                .catch(err => {
                    console.error(err);
                    document.getElementById('employeeSelect').innerHTML = '<option>‚ùå ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</option>';
                });
        }

        function selectType(type, btn) {
            selectedType = type;
            document.querySelectorAll('.btn-select').forEach(b => {
                b.classList.remove('active', 'ring-2', 'ring-blue-500');
            });
            btn.classList.add('active', 'ring-2', 'ring-blue-500');

            const box = document.getElementById('complaintBox');
            if (type === '‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô') {
                box.classList.remove('hidden');
            } else {
                box.classList.add('hidden');
                document.getElementById('complaintDetail').value = ''; 
            }
        }

        function getLocation() {
            const btn = document.getElementById('btnGPS');
            const label = document.getElementById('gpsLabel');
            
            btn.disabled = true;
            label.innerHTML = '<div class="loader"></div>'; 

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude.toFixed(6);
                        const lng = position.coords.longitude.toFixed(6);
                        document.getElementById("gpsInput").value = `${lat}, ${lng}`;
                        
                        btn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                        btn.classList.add('bg-green-500', 'hover:bg-green-600');
                        label.innerText = '‡πÑ‡∏î‡πâ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÅ‡∏•‡πâ‡∏ß';
                        btn.disabled = false;
                    },
                    (error) => {
                        Swal.fire('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á GPS ‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î Location ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠', 'error');
                        label.innerText = '‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà';
                        btn.disabled = false;
                    },
                    { enableHighAccuracy: true, timeout: 10000 }
                );
            } else {
                Swal.fire('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', 'Browser ‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö GPS', 'error');
                btn.disabled = false;
            }
        }

        // --- üõ†Ô∏è ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà: ‡∏¢‡πà‡∏≠‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (Resize Image) ---
        function previewAndResizeImage(input) {
            if (input.files && input.files[0]) {
                const file = input.files[0];
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
                document.getElementById('cameraIcon').classList.add('hidden');
                document.getElementById('processingImg').classList.remove('hidden');

                const reader = new FileReader();
                reader.onload = function(event) {
                    const img = new Image();
                    img.onload = function() {
                        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ (800px ‡∏Å‡πá‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏π‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô)
                        const MAX_WIDTH = 800;
                        const MAX_HEIGHT = 800;
                        
                        let width = img.width;
                        let height = img.height;

                        // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡πà‡∏≠‡∏£‡∏π‡∏õ
                        if (width > height) {
                            if (width > MAX_WIDTH) {
                                height *= MAX_WIDTH / width;
                                width = MAX_WIDTH;
                            }
                        } else {
                            if (height > MAX_HEIGHT) {
                                width *= MAX_HEIGHT / height;
                                height = MAX_HEIGHT;
                            }
                        }

                        // ‡∏™‡∏£‡πâ‡∏≤‡∏á Canvas ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏î‡∏£‡∏π‡∏õ‡πÉ‡∏´‡∏°‡πà
                        const canvas = document.createElement('canvas');
                        canvas.width = width;
                        canvas.height = height;
                        const ctx = canvas.getContext("2d");
                        ctx.drawImage(img, 0, 0, width, height);

                        // ‡πÅ‡∏õ‡∏•‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô Base64 (JPEG Quality 0.7 = 70%)
                        // ‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏•‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏¢‡∏≠‡∏∞‡∏°‡∏≤‡∏Å (‡∏à‡∏≤‡∏Å 5MB ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ~200KB)
                        const resizedBase64 = canvas.toDataURL("image/jpeg", 0.7);

                        // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
                        document.getElementById('preview').src = resizedBase64;
                        document.getElementById('preview').classList.remove('hidden');
                        document.getElementById('processingImg').classList.add('hidden');
                        document.getElementById('btnRemoveImg').classList.remove('hidden');
                        
                        // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡πÑ‡∏ß‡πâ‡∏™‡πà‡∏á
                        base64Image = resizedBase64;
                    }
                    img.src = event.target.result;
                }
                reader.readAsDataURL(file);
            }
        }
        
        function removeImage(e) {
            e.stopPropagation(); 
            document.getElementById('cameraInput').value = "";
            document.getElementById('preview').src = "";
            document.getElementById('preview').classList.add('hidden');
            document.getElementById('cameraIcon').classList.remove('hidden');
            document.getElementById('btnRemoveImg').classList.add('hidden');
            base64Image = "";
        }

        function submitData() {
            const name = document.getElementById('employeeSelect').value;
            const gps = document.getElementById('gpsInput').value;
            let details = "";

            if (!name) return Swal.fire('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà', 'warning');
            if (!selectedType) return Swal.fire('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô', 'warning');
            
            if (selectedType === '‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô') {
                details = document.getElementById('complaintDetail').value;
                if (!details) return Swal.fire('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤', 'warning');
            }

            if (!gps) return Swal.fire('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏∂‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î GPS', 'warning');
            if (!base64Image) return Swal.fire('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô', 'warning');

            // SweetAlert2 Loading
            Swal.fire({
                title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
                html: '‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                allowOutsideClick: false,
                didOpen: () => { Swal.showLoading() }
            });

            const payload = {
                employee: name,
                type: selectedType,
                details: details,
                gps: gps,
                image: base64Image
            };

            fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify(payload)
            })
            .then(res => res.json())
            .then(data => {
                if(data.status === 'success'){
                    Swal.fire({
                        icon: 'success',
                        title: '‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                        text: '‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
                        confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
                        confirmButtonColor: '#3b82f6'
                    }).then(() => {
                        location.reload();
                    });
                } else {
                    throw new Error(data.message);
                }
            })
            .catch(err => {
                Swal.fire('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', err.message, 'error');
            });
        }
    </script>
</body>
</html>
